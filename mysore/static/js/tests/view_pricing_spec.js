describe('Rules Calendar', function() {
    var $controller, ctrl, UserProfile, ngDialog, $scope, $state;
    var weekstrip = [{"day":"M","isWeekend":false},{"day":"T","isWeekend":false},{"day":"W","isWeekend":false},{"day":"T","isWeekend":false},{"day":"F","isWeekend":false},{"day":"S","isWeekend":false},{"day":"S","isWeekend":true},{"day":"M","isWeekend":false},{"day":"T","isWeekend":false},{"day":"W","isWeekend":false},{"day":"T","isWeekend":false},{"day":"F","isWeekend":false},{"day":"S","isWeekend":false},{"day":"S","isWeekend":true},{"day":"M","isWeekend":false},{"day":"T","isWeekend":false},{"day":"W","isWeekend":false},{"day":"T","isWeekend":false},{"day":"F","isWeekend":false},{"day":"S","isWeekend":false},{"day":"S","isWeekend":true},{"day":"M","isWeekend":false},{"day":"T","isWeekend":false},{"day":"W","isWeekend":false},{"day":"T","isWeekend":false},{"day":"F","isWeekend":false},{"day":"S","isWeekend":false},{"day":"S","isWeekend":true},{"day":"M","isWeekend":false},{"day":"T","isWeekend":false},{"day":"W","isWeekend":false},{"day":"T","isWeekend":false},{"day":"F","isWeekend":false},{"day":"S","isWeekend":false},{"day":"S","isWeekend":true},{"day":"M","isWeekend":false},{"day":"T","isWeekend":false}];
    var rulesData = {"price_overrides":{"1":{"room_id":1,"prices":{"2016-06-21":100,"2016-06-10":6000,"2016-06-14":6000,"2016-06-05":45,"2016-06-07":9000,"2016-06-19":3000,"2016-06-03":2000,"2016-06-04":23}},"3":{"room_id":3,"prices":{}},"4":{"room_id":4,"prices":{}},"2":{"room_id":2,"prices":{"2016-06-21":800,"2016-06-17":100,"2016-06-10":100,"2016-06-14":4000,"2016-06-07":7000,"2016-06-16":9000,"2016-06-08":4000,"2016-06-15":5000}}},"hotel":{"$oid":"574d61206127c92b80a84b55"},"promotional_prices":[{"name":"promo 2","description":"","creation_date":{"$date":1465414341626},"start_time":56,"hotel_occupancies":[{"prices":[{"occupancy":100,"price":50,"delta":0,"offset":100}]}],"local_id":2,"status":"1","end_time":56,"rooms":[1,2],"days":[]},{"name":"mine","description":"","creation_date":{"$date":1464894551367},"start_time":5,"hotel_occupancies":[{"prices":[{"occupancy":100,"price":0,"delta":0,"offset":100}]}],"local_id":1,"status":"DELETED","end_time":10,"rooms":[1],"days":[]}],"_id":{"$oid":"5750002f6127c91918d5192b"},"occupancy_prices":[{"name":"second","priority":2,"creation_date":{"$date":1465414302807},"date_range":{"_cls":"DateRange","start":{"$date":1466121600000},"end":{"$date":1467244800000}},"local_id":2,"description":"","rooms":{"1":{"prices":[{"occupancy":100,"price":6000,"delta":0,"offset":100}]},"4":{"prices":[{"occupancy":100,"price":6000,"delta":0,"offset":100}]},"3":{"prices":[{"occupancy":100,"price":6000,"delta":0,"offset":100}]},"2":{"prices":[{"occupancy":100,"price":6500,"delta":500,"offset":100}]}},"status":"1","rate_plans":{},"days":[true,true,true,true,true,true,true],"room_occupancies":{}},{"name":"test","priority":1,"creation_date":{"$date":1464880519698},"date_range":{"_cls":"DateRange","start":{"$date":1464912000000},"end":{"$date":1471046400000}},"local_id":1,"description":"","rooms":{"1":{"prices":[{"occupancy":100,"price":1000,"delta":0,"offset":100}]},"4":{"prices":[{"occupancy":100,"price":1000,"delta":0,"offset":100}]},"3":{"prices":[{"occupancy":100,"price":1000,"delta":0,"offset":100}]},"2":{"prices":[{"occupancy":100,"price":1000,"delta":0,"offset":100}]}},"status":"DELETED","rate_plans":{},"days":[true,true,true,true,true,true,true],"room_occupancies":{}}]};
    // var monthSet = [{"name":"Jun","dates":["","",{"date":1,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":5,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":6,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":12,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":13,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"Fr","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":18,"day":"Sa","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":true},{"date":19,"day":"Su","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":true},{"date":20,"day":"Mo","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":21,"day":"Tu","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":22,"day":"We","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":23,"day":"Th","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":24,"day":"Fr","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":25,"day":"Sa","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":true},{"date":26,"day":"Su","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":true},{"date":27,"day":"Mo","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":28,"day":"Tu","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":29,"day":"We","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false},{"date":30,"day":"Th","hasRule":true,"content":{"applicable":true,"type":"occupancy","name":"second","class":"rule_2"},"isWeekend":false}]},{"name":"Jul","dates":["","","","",{"date":1,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":3,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":4,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":5,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":10,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":11,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":12,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":17,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":18,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":19,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":24,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":25,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":26,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":29,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":30,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":31,"day":"Su","hasRule":false,"content":null,"isWeekend":true}]},{"name":"Aug","dates":[{"date":1,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Th","hasRule":true,"content":{"applicable":true,"type":"promo","name":"promo 2","class":"rule_2"},"isWeekend":false},{"date":5,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":7,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":8,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":12,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":14,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":15,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":19,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":21,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":22,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":26,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":28,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":29,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":30,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":31,"day":"We","hasRule":false,"content":null,"isWeekend":false}]},{"name":"Sep","dates":["","","",{"date":1,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":4,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":5,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":11,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":12,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":18,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":19,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":25,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":26,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":29,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":30,"day":"Fr","hasRule":false,"content":null,"isWeekend":false}]},{"name":"Oct","dates":["","","","","",{"date":1,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":2,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":3,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":5,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":9,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":10,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":12,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":16,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":17,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":19,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":23,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":24,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":26,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":29,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":30,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":31,"day":"Mo","hasRule":false,"content":null,"isWeekend":false}]},{"name":"Nov","dates":["",{"date":1,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":5,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":6,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":7,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":12,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":13,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":14,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":19,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":20,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":21,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":26,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":27,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":28,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":29,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":30,"day":"We","hasRule":false,"content":null,"isWeekend":false}]},{"name":"Dec","dates":["","","",{"date":1,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":4,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":5,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":11,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":12,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":18,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":19,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":25,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":26,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":29,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":30,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":31,"day":"Sa","hasRule":false,"content":null,"isWeekend":true}]},{"name":"Jan","dates":["","","","","","",{"date":1,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":2,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":5,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":8,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":9,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":12,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":15,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":16,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":19,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":22,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":23,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":26,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":29,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":30,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":31,"day":"Tu","hasRule":false,"content":null,"isWeekend":false}]},{"name":"Feb","dates":["","",{"date":1,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":5,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":6,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":12,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":13,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":19,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":20,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":26,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":27,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"Tu","hasRule":false,"content":null,"isWeekend":false}]},{"name":"Mar","dates":["","",{"date":1,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":5,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":6,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":12,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":13,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":19,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":20,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":26,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":27,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":29,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":30,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":31,"day":"Fr","hasRule":false,"content":null,"isWeekend":false}]},{"name":"Apr","dates":["","","","","",{"date":1,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":2,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":3,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":5,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":7,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":8,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":9,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":10,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":12,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":14,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":15,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":16,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":17,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":19,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":21,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":22,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":23,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":24,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":26,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":28,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":29,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":30,"day":"Su","hasRule":false,"content":null,"isWeekend":true}]},{"name":"May","dates":[{"date":1,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":2,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":3,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":4,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":5,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":6,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":7,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":8,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":9,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":10,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":11,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":12,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":13,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":14,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":15,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":16,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":17,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":18,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":19,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":20,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":21,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":22,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":23,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":24,"day":"We","hasRule":false,"content":null,"isWeekend":false},{"date":25,"day":"Th","hasRule":false,"content":null,"isWeekend":false},{"date":26,"day":"Fr","hasRule":false,"content":null,"isWeekend":false},{"date":27,"day":"Sa","hasRule":false,"content":null,"isWeekend":true},{"date":28,"day":"Su","hasRule":false,"content":null,"isWeekend":true},{"date":29,"day":"Mo","hasRule":false,"content":null,"isWeekend":false},{"date":30,"day":"Tu","hasRule":false,"content":null,"isWeekend":false},{"date":31,"day":"We","hasRule":false,"content":null,"isWeekend":false}]}];

    beforeEach(function() {
        module('priceCalendar');
        module('ui.router');

        // Provide will help us create fake implementations for our dependencies
        module(function($provide) {

            // Fake UserProfile Implementation
            $provide.value('UserProfile', {
                getCompareWith: function () {
                   return 'last_year';
                },
                getNumWeeks: function () {
                    return numWeeks;
                },
                setNumWeeks: function (count) {
                    numWeeks = count;
                }
            });

            // Fake rules Implementation
            $provide.value('rules', rulesData);

            // Fake ngDialog Implementation
            $provide.value('ngDialog', {
                getCompareWith: function () {
                   return 'last_year';
                }
            });

            return null;
        });
    });

    beforeEach(function() {

        // When Angular Injects the UserProfile dependency,
        // it will use the implementation we provided above
        inject(function($controller, $rootScope, _$state_, _UserProfile_, _ngDialog_, _rules_) {
            $scope = $rootScope.$new();
            $state = _$state_;
            UserProfile = _UserProfile_;
            ngDialog = _ngDialog_;
            rules = _rules_;
            ctrl = $controller('viewPriceController', {
                    $scope: $scope
                });
        });
    });

    it("should say no rules when rules are empty array", function() {
        expect(ctrl.noRules).toBeFalsy();
        rules = [];
        ctrl.init(rules);
        expect(ctrl.noRules).toBeTruthy();
    });

    it("should plot the calendar without rules if all rules are deleted", function() {
        rules = [];
        ctrl.init(rules);
        expect(ctrl.noRules).toBeTruthy();

        rules = {
            "promotional_prices": [{"status": "DELETED"}],
            "occupancy_prices": [{"status": "DELETED"}]
        };
        ctrl.init(rules);
        // if no rules is false, calendar will be plotted
        expect(ctrl.noRules).toBeFalsy();
    });

    it('should generate the weekstrip based on 12 months from now', function () {
        expect(ctrl.weekStrip).toEqual(weekstrip);
    });

    it('should generate the 12 month calendar with active rules', function () {
        var monthSet = ctrl.yearGenerator(moment().year(), rules);
        expect(ctrl.monthSet).toEqual(monthSet);
    });


});
